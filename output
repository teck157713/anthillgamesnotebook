from pyspark.sql import SQLContext
sqlContext = SQLContext(sc)

credentials_1 = {
  'password':"""pw""",
  'custom_url':'blahblah-bluemix.cloudant.com',
  'username':'yrusername',
  'url':'https://undefined'
}

cloudantdata = spark.read.format("org.apache.bahir.cloudant")\
       .option("cloudant.host",credentials_1['custom_url'].split('@')[1])\
       .option("cloudant.username", credentials_1['username'])\
       .option("cloudant.password",credentials_1['password'])\
       .load("anthillgames").createOrReplaceTempView("anthill")

res = spark.sql("select sqrt(sum(X*X)+sum(Y*Y)+sum(Z*Z)) as energy, SENSORID from anthill group by SENSORID order by energy desc")
res.show()
